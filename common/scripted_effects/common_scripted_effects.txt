Enable_Trade_Embargo = {
    meta_effect = {
		text = {
			[EMBARGO_TARGET] = {
                add_opinion_modifier = {
                    target = [EMBARGO_INITIATOR]
                    modifier = Trade_Embargo
                }
            }
            [EMBARGO_INITIATOR] = {
                add_opinion_modifier = {
                    target = [EMBARGO_TARGET]
                    modifier = Trade_Embargo_Opinion
                }
            }
		}
		EMBARGO_TARGET = "[?embargo_target.GetTag]"
		EMBARGO_INITIATOR = "[?embargo_initiator.GetTag]"
	}
}

Disable_Trade_Embargo = {
    meta_effect = {
		text = {
			[EMBARGO_TARGET] = {
                remove_opinion_modifier = {
                    target = [EMBARGO_INITIATOR]
                    modifier = Trade_Embargo
                }
            }
            [EMBARGO_INITIATOR] = {
                remove_opinion_modifier = {
                    target = [EMBARGO_TARGET]
                    modifier = Trade_Embargo_Opinion
                }
            }
		}
		EMBARGO_TARGET = "[?embargo_target.GetTag]"
		EMBARGO_INITIATOR = "[?embargo_initiator.GetTag]"
	}
}

Switch_Trade_Embargo = {
    if = {
        limit = {
            check_variable = {
                opinion_modifier_action = 0
            }
        }
        Disable_Trade_Embargo = yes
    }
    else = {
        Enable_Trade_Embargo = yes
    }
    clear_variable = opinion_modifier_action
    clear_variable = embargo_target
    clear_variable = embargo_initiator
}